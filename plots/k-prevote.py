#!/usr/bin/env python3

import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d

# Provided data
k_values = np.array([
    0.01, 0.21000000000000002, 0.41000000000000003, 0.6100000000000001, 0.81, 1.01, 1.21, 1.41, 1.6099999999999999,
    1.8099999999999998, 2.01, 2.21, 2.41, 2.6100000000000003, 2.8100000000000005, 3.0100000000000007, 3.210000000000001,
    3.410000000000001, 3.610000000000001, 3.8100000000000014, 4.010000000000002, 4.210000000000002, 4.410000000000002,
    4.610000000000002, 4.810000000000002, 5.0100000000000025, 5.210000000000003, 5.410000000000003, 5.610000000000003,
    5.810000000000003, 6.010000000000003, 6.2100000000000035, 6.410000000000004, 6.610000000000004, 6.810000000000004,
    7.010000000000004, 7.210000000000004, 7.410000000000005, 7.610000000000005, 7.810000000000005, 8.010000000000005,
    8.210000000000004, 8.410000000000004, 8.610000000000003, 8.810000000000002, 9.010000000000002, 9.21, 9.41, 9.61,
    9.809999999999999
])
p_values = np.array([
    0.09232451039567147, 0.08784752555368107, 0.08378465401079187, 0.0800809785043788, 0.07669088110221135,
    0.07357615478568916, 0.07070455725022946, 0.06804869064616516, 0.0655851246600086, 0.06329370342309187,
    0.06115699280721838, 0.05915983601575649, 0.05728899349738751, 0.055532849088644934, 0.05388116859661848,
    0.052324900219293084, 0.05085600858210816, 0.049467335965272204, 0.048152485662689044, 0.04690572346127911,
    0.04572189403937788, 0.0445963497133503, 0.043524889455696894, 0.04250370649771948, 0.04152934313918869,
    0.04059865163442628, 0.039708760222471204, 0.038857043528976856, 0.038041096697236335, 0.03725871271146101,
    0.03650786246199316, 0.03578667717329874, 0.035093432874345, 0.03442653663967634, 0.03378451437003518,
    0.03316599991523072, 0.03256972537033362, 0.031994512400142436, 0.031439264467006234, 0.030902959854133827,
    0.03038464539099541, 0.02988343079974545, 0.02939848359212192, 0.028929024455288645, 0.028474323072824756,
    0.02803369433372518, 0.027606494888022543, 0.027192120012610854, 0.026790000755159776, 0.026399601327752247
])

# Create interpolation function
interp_func = interp1d(k_values, p_values, kind='cubic')

# Generate finer k values for a smoother curve
k_fine = np.linspace(min(k_values), max(k_values), 500)
p_fine = interp_func(k_fine)

# Plot the data
plt.figure(figsize=(10, 6))
plt.plot(k_fine, p_fine, '-', label="Prevote Throughput", color="blue")
plt.title("Prevote throughput vs coefficient k")
plt.xlabel("Coefficient k")
plt.ylabel("Throughput")
plt.legend()
plt.grid()
plt.show()
plt.savefig('k-prevote.png')
